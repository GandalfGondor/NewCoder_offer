第一章 概述
TCP/IP通常被认为是一个四层协议系统
应用层、运输层、网络层、链路层。运输层有TCP和UDP，网络层有IP、ICMP、IGMP。
应用层有Telnet远程登录，FTP，SMTP，SNMP。
网桥是在链路层上对网络进行互联。路由器是在网络层上进行互联。

封装：
当应用程序用TCP传输，数据送入协议栈中，逐个通过每一层直到被当做一串比特流送入网络，其中每一层对收到的数据
都要增加一些首部信息。

TCP传给IP的数据单元称作 TCP报文段或简称为TCP
segment. IP传给网络接口层的数据单元称作IP数据报(IP datagram)。通过以太网传输的比特流称作帧(Frame)。

分用：当主机收到一个以太网数据帧，数据从协议栈由底层向上升，同时去掉各层协议加上报文首部，每层协议盒
要去检查报文首部中协议标识，确定接收数据的上层协议。

网络层和运输层之间的区别是最为关键的：网络层(IP)提供点到点的服务，而运输层(TCP和UDP)提供端到端的服务。

第二章 链路层
链路层最大数据帧长度MTU（最大传输单元）
重要的不是两台主机所在网络的MTU的值，重要的是两台通信主机路径中的最小MTU它被称作路径M T U。

第三章 IP网际协议
IP特性：不可靠的意思是它不能保证IP数据报能成功地到达目的地。
无连接这个术语的意思是IP并不维护任何关于后续数据报的状态信息。

TTL生存时间字段设置了数据报可以经过的最多路由器数。它指定了数据报的生存时间。 
TTL的初始值由源主机设置（通常为 3 2或6 4），一旦经过一个处理它的路由器，它的值就减去 1。
当该字段的值为 0时，数据报就被丢弃，并发送ICMP报文通知源主机。

IP层在内存中有一个路由表。当收到一份数据报并进行发送时，它都要对该表搜索一次。当数据报来自某
个网络接口时，IP首先检查目的IP地址是否为本机的IP地址之一或者IP广播地址。如果确实是这样，数据
报就被送到由IP首部协议字段所指定的协议模块进行处理。如果数据报的目的不是这些地址，那么
(1)如果 I P层被设置为路由器的功能，那么就对数据报进行转发
否则(2)数据报被丢弃。

路由表内容：目的IP地址。下一跳路由器IP地址。标志。网络接口。
IP路由选择是逐跳地进行的。首先匹配IP地址(主机地址)，其次匹配网络号，不行寻找默认表目。

第四章 ARP：地址解析协议
ARP为IP地址到对应的硬件地址之间提供动态映射。我们之所以用动态这个词是因为这个过程是自动完成的，
一般应用程序用户或系统管理员不必关心。

ARP的功能是在32 bit的IP地址和采用不同网络技术的硬件地址之间提供动态映射。

第五章 RARP：逆地址解析协议

第六章 ICMP：Internet控制报文协议
ICMP报文是在IP数据报内部被传输的。
ICMP分为差错报文和查询报文

ICMP地址掩码请求与应答：系统广播它的ICMP请求报文
ICMP时间戳请求允许系统向另一个系统查询当前的时间。
ICMP差错报文，即端口不可达报文

第七章 Ping程序
目的是为了测试另一台主机是否可达。该程序发送一份ICMP回显请求报文给主机，并等待返回ICMP回显应答。

第八章 Traceroute程序
Traceroute程序程序可以让我们看到IP数据报从一台主机传到另一台主机所经过的路由。
Traceroute程序程序还可以让我们使用IP源路由选项。
Traceroute程序使用ICMP报文和IP首部中的TTL字段（生存周期）。

工作过程：
开始时发送一个TTL字段为 1的UDP数据报，然后将TTL字段每次加 1，以确定路径中的每个路由器。
每个路由器在丢弃UDP数据报时都返回一个ICMP超时报文2而最终目的主机则产生一个ICMP端口不可达的报文。

第九章 IP选路 
netstat -rn 查看路由表
当分组被发往间接路由时，IP地址指明的是最终目的地，但是链路层地址指明的是网关(即下一站路由器)。
G标志区分了直接路由和间接路由。H标志表明，目的地址(netstat命令输出第一行)是一个完整的主机地址。
ICMP重定向差错：当IP数据报应该被发送到另一个路由器时，收到数据报的路由器就要发送 I C M P重定向差
错报文给IP数据报的发送端。
路由守护程序（Routing Daemon）是在路由器上运行路由选择协议的程序，与它的邻居路由器进行对话，通常
被叫做路由守护程序。这个路由守护程序在接收到来自邻居路由器的信息时更新 kernel 路由表。

